<%namespace file="/include.html" name="include" import="*"/>
<%def name="head()">
    ${include.jquery_form()}
    ${self.adds_head()}
</%def>
<%def name="adds_head()"></%def>
<%def name="form_id()">${next.form_id()}</%def>
<%def name="all_body()">
<script type="text/javascript">
    $(document).ready(function(){
        var options = { 
            dataType:  'json',
            beforeSubmit:  function() {
                //$('#${form_id()} :input').enable(false);
                $('#${form_id()}-loader').addClass('loading')
            },
            success: function(data) {
                if (data.form){
                	$('#${form_id()}-container').html('')
                    $('#${form_id()}-container').html(data.form);
                    $('#${form_id()}-loader').removeClass('loading')
                    
                }
                if (data.script){
                    $('#script').html(data.script);
                }
            }  
        };
        
        $('#${form_id()}').submit(function() {
            $(this).ajaxSubmit(options);
            return false;
        })
    });
</script>
<div id="${form_id()}-container" class="form-container">
    <div id="${form_id()}-loader"></div>
    ${next.body()}
</div>
</%def>
${all_body()}